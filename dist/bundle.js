!function(e){var i={};function t(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=i,t.d=function(e,i,s){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var n in e)t.d(s,n,function(i){return e[i]}.bind(null,n));return s},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=0)}([function(e,i,t){"use strict";t.r(i);class s{constructor({position:e}){this.position=[e[0],e[1]],this.images=[new Image,new Image,new Image],this.images[0].src="./assets/minion.png",this.images[1].src="./assets/minion2.png",this.images[2].src="./assets/surprised_minion.png",this.width=50,this.height=50,this.velocity=10,this.tickCount=0,this.ticksPerFrame=4,this.frameIndex=0}update(){this.tickCount+=1,this.jumping||this.tickCount>this.ticksPerFrame&&(this.tickCount=0,0===this.frameIndex?this.frameIndex=1:this.frameIndex=0),this.jumping&&(this.frameIndex=0)}render(e){this.jump(),this.draw(e)}isCollidedWith(e){return this.position[0]<e.position[0]+e.width&&this.position[0]+this.width>e.position[0]&&this.position[1]<e.position[1]+e.height&&this.position[1]+this.height>e.position[1]}jump(){this.jumping&&(this.velocity>-10?(this.position[1]-=this.velocity,this.velocity-=.3):(this.position[1]=250,this.velocity=10,this.jumping=!1))}draw(e){e.drawImage(this.images[this.frameIndex],this.position[0],this.position[1],this.width,this.height)}}class n{constructor(e){this.game=e,this.position=[600,50],this.width=300,this.height=300,this.score=0,this.highScore=null}renderStageCompletion(e,i){e.font="25px Work Sans",e.fillText(i,200,80)}renderSurvivalCompletion(e,i){e.font="25px Work Sans",e.fillText(i,200,80)}render(e){this.draw(e)}draw(e){this.score+=1,e.font="20px Work Sans",e.fillText(`Score: ${this.score}`,650,40),e.font="15px Work Sans",e.fillText(`Local High Score: ${this.game.prevHighScore}`,600,20),void 0!==this.game.globalHighScore&&e.fillText(`Global High Score: ${this.game.globalHighScore}`,350,20),this.game.muted?e.fillText("Muted (click screen to toggle mute)",10,20):e.fillText("Umuted (click screen to toggle mute)",10,20)}drawGameOverText(e){null===this.highScore&&(this.highScore=this.score),this.score>this.highScore&&(this.highScore=this.score,e.fillText(`New High Score!: ${this.score}`,200,40)),e.font="20px Work Sans",e.fillText(`Final Score: ${this.score} Press r to restart game`,200,40)}}const o={fetchHighScores(e,i){e.ref("scores/").on("value",e=>{document.getElementById("highscore1").textContent="1: "+e.val().highscore,document.getElementById("highscore2").textContent="2: "+e.val().highscore2,document.getElementById("highscore3").textContent="3: "+e.val().highscore3,i.globalLeaderScores=e.val(),i.globalHighScore=i.globalLeaderScores.highscore})},setHighScores(e,i){i.menu.score>i.globalLeaderScores.highscore?(e.ref("scores/highscore3").set(i.globalLeaderScores.highscore2),e.ref("scores/highscore2").set(i.globalLeaderScores.highscore),e.ref("scores/highscore").set(i.menu.score)):i.menu.score>i.globalLeaderScores.highscore2?(e.ref("scores/highscore3").set(i.globalLeaderScores.highscore2),e.ref("scores/highscore2").set(i.menu.score)):i.menu.score>i.globalLeaderScores.highscore3&&e.ref("scores/highscore3").set(i.menu.score)}},r={minionPosition:[10,250],evilMinionOnePosition:[900,250],evilMinionTwoPosition:[1200,250],evilMinionThreePosition:[1500,250],evilMinionFourPosition:[1800,250],skyscraperOnePosition:[725,200],skyscraperTwoPosition:[1200,200],flyingObstaclePosition:[2e3,60]},a={EASY_START:"easy-start",MEDIUM_START:"medium-start",HARD_START:"hard-start"},h={minionPosition:r.minionPosition,skyscraperVelocity:4,airplaneVelocity:4,obstacleResetPosition:1100,evilMinionHeight:50,evilMinionWidth:50,evilMinionVelocity:4,evilMinionOnePosition:r.evilMinionOnePosition,evilMinionTwoPosition:r.evilMinionTwoPosition,evilMinionThreePosition:r.evilMinionThreePosition,evilMinionFourPosition:r.evilMinionFourPosition,skyscraperOnePosition:r.skyscraperOnePosition,skyscraperTwoPosition:r.skyscraperTwoPosition,flyingObstaclePosition:r.flyingObstaclePosition,flyingObstacleResetPosition:2e3,flyingObstacleWidth:50,flyingObstacleHeight:40,flyingObstacleSrcs:["./assets/Fly1.png","./assets/Fly2.png"],skyscraperImage:"./assets/skyscraper.png",skyscraperWidth:80,skyscraperHeight:100,skyscraper2Image:"./assets/fat-tall-sky.png",evilMinionSrcs:["./assets/evil_minion1.png","./assets/evil_minion2.png","./assets/evil_minion3.png","./assets/evil_minion4.png","./assets/evil_minion5.png","./assets/evil_minion6.png"]},c={skyscraperVelocity:4,airplaneVelocity:10},l={skyscraperVelocity:5,airplaneVelocity:12};class g{constructor({position:e,resetPosition:i,velocity:t,width:s,height:n,srcs:o}){this.position=[e[0],e[1]],this.initialPosition=[e[0],e[1]],this.resetPosition=i,this.velocity=t,this.width=s,this.height=n,this.frameIndex=0,this.srcs=o,this.generateImages(),this.tickCount=0,this.ticksPerFrame=4,this.timesPassed=0,this.activated=!0}resetObstacle(){this.position=[this.initialPosition[0],this.initialPosition[1]]}generateImages(){this.images=[];for(let e=0;e<this.srcs.length;e++)this.images.push(new Image),this.images[e].src=this.srcs[e]}update(){this.images.length>1?(this.tickCount+=1,this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex+=1,this.frameIndex===this.images.length&&(this.frameIndex=0))):this.frameIndex=0}render(e){this.move(),this.draw(e)}move(){this.position[0]<=-45?(this.position[0]=this.resetPosition,this.timesPassed+=1):this.position[0]-=this.velocity}draw(e){e.drawImage(this.images[this.frameIndex],this.position[0],this.position[1],this.width,this.height)}}const d={1:{banner:null,endingBanner:null,stageCountEnding:879,obstaclePasses:2},2:{banner:{text:"Oh no! Evil Minions are on the loose!",duration:[880,1e3]},endingBanner:{text:"You survived the Evil Minions!",duration:[1700,1800]},stageCountEnding:1800,obstaclePasses:1}},u=(e,i)=>{const t=[new g({position:e.skyscraperOnePosition,resetPosition:e.obstacleResetPosition,velocity:e.skyscraperVelocity,width:e.skyscraperWidth,height:e.skyscraperHeight,srcs:[e.skyscraperImage]}),new g({position:e.skyscraperTwoPosition,resetPosition:e.obstacleResetPosition,velocity:e.skyscraperVelocity,width:e.skyscraperWidth,height:e.skyscraperHeight,srcs:[e.skyscraper2Image]})];return i!==a.HARD_START&&i!==a.MEDIUM_START||t.push(new g({position:e.flyingObstaclePosition,resetPosition:e.flyingObstacleResetPosition,velocity:e.airplaneVelocity,width:e.flyingObstacleWidth,height:e.flyingObstacleHeight,srcs:e.flyingObstacleSrcs})),t},m=e=>[new g({position:e.evilMinionOnePosition,resetPosition:e.obstacleResetPosition,velocity:e.evilMinionVelocity,width:e.evilMinionWidth,height:e.evilMinionHeight,srcs:e.evilMinionSrcs}),new g({position:e.evilMinionTwoPosition,resetPosition:e.obstacleResetPosition,velocity:e.evilMinionVelocity,width:e.evilMinionWidth,height:e.evilMinionHeight,srcs:e.evilMinionSrcs}),new g({position:e.evilMinionThreePosition,resetPosition:e.obstacleResetPosition,velocity:e.evilMinionVelocity,width:e.evilMinionWidth,height:e.evilMinionHeight,srcs:e.evilMinionSrcs}),new g({position:e.evilMinionFourPosition,resetPosition:e.obstacleResetPosition,velocity:e.evilMinionVelocity,width:e.evilMinionWidth,height:e.evilMinionHeight,srcs:e.evilMinionSrcs})];class p{constructor(e,i,t){this.ctx=e,this.canvas=i,this.database=t,this.obstacles={},this.gameOver=!1,this.draw=this.draw.bind(this),this.setKeyboardListeners(),this.setEventListeners(),this.muted=!1,this.jumpSound=new Audio("./assets/audio/jump1.m4a"),this.gameOverSound=new Audio("./assets/audio/game_over.mp3"),this.prevHighScore=0,this.stageCount=0,this.getHighScores()}setKeyboardListeners(){document.addEventListener("keydown",e=>{switch(e.keyCode){case 32:this.activateJump();break;case 82:this.gameOver&&this.resetGame();break;case 80:this.togglePause()}}),document.querySelector(".jump-button").addEventListener("click",()=>{this.activateJump()})}setEventListeners(){this.canvas.addEventListener("click",()=>this.mute())}mute(){this.muted?this.muted=!1:this.muted=!0}resetGame(){this.menu.highScore>this.prevHighScore&&(this.prevHighScore=this.menu.highScore),this.start(this.difficulty)}togglePause(){this.paused?(this.canvas.classList.remove("paused"),this.paused=!1,this.draw()):(this.canvas.classList.add("paused"),this.paused=!0)}activateJump(){this.muted||this.minion.jumping||this.gameOver||this.jumpSound.play(),this.minion.jumping=!0,this.minion.imageCount=0}manageGameOver(){this.gameOver=!0,this.finalFrame=!0}prepareNextStage(){d[this.stage].stageCountEnding<this.stageCount&&d[this.stage+1]&&(this.stage+=1,this.obstacles[this.stage].forEach(e=>{e.resetObstacle(),e.activated=!0,e.timesPassed=0})),!d[this.stage+1]&&this.stageCount>d[this.stage].stageCountEnding&&(this.stageCount=0,this.stage=1,this.obstacles[1].forEach(e=>{e.resetObstacle(),e.activated=!0,e.timesPassed=0}))}drawStage(){this.obstacles[this.stage].forEach(e=>{e.activated&&(e.update(),e.render(this.ctx),this.minion.isCollidedWith(e)&&this.manageGameOver(),e.timesPassed>d[this.stage].obstaclePasses&&(e.activated=!1,e.timesPassed=0))}),d[this.stage].banner&&this.stageCount>d[this.stage].banner.duration[0]&&this.stageCount<d[this.stage].banner.duration[1]&&this.menu.renderStageCompletion(this.ctx,d[this.stage].banner.text),d[this.stage].banner&&this.stageCount>d[this.stage].endingBanner.duration[0]&&this.stageCount<d[this.stage].endingBanner.duration[1]&&this.menu.renderSurvivalCompletion(this.ctx,d[this.stage].endingBanner.text)}draw(){this.gameOver||this.paused||(this.stageCount+=1,this.ctx.clearRect(0,0,800,300),requestAnimationFrame(this.draw),this.menu.render(this.ctx),this.minion.update(),this.minion.render(this.ctx),this.prepareNextStage(),this.drawStage()),this.finalFrame&&(this.ctx.clearRect(0,0,800,300),this.menu.render(this.ctx),this.setHighScores(),this.minion.frameIndex=2,this.minion.render(this.ctx),this.drawStage()),this.gameOver&&(this.finalFrame=!1,this.canvas.classList.add("paused"),this.muted||this.gameOverSound.play(),this.menu.drawGameOverText(this.ctx))}generateMenu(){this.menu=new n(this)}setDifficulty(){const{MEDIUM_START:e,HARD_START:i,EASY_START:t}=a;switch(this.difficulty){case t:return Object.assign({},h);case e:return Object.assign({},h,c);case i:return Object.assign({},h,l);default:return Object.assign({},h)}}generatePieces(){const e=this.setDifficulty();this.minion=new s({position:e.minionPosition}),this.obstacles={1:u(e,this.difficulty),2:m(e)}}getHighScores(){o.fetchHighScores(this.database,this)}setHighScores(){o.setHighScores(this.database,this)}start(e){this.canvas.classList.remove("paused"),this.canvas.focus(),this.difficulty=e,this.stage=1,this.stageCount=0,this.paused=!1,this.gameOver=!1,this.generateMenu(),this.generatePieces(),this.draw()}}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("game-canvas"),i=e.getContext("2d");firebase.initializeApp({apiKey:"AIzaSyBkc22wgBkJD-I-jOz20CbzBDLNm25mqnw",authDomain:"minionrunner-c5d40.firebaseapp.com",databaseURL:"https://minionrunner-c5d40.firebaseio.com",projectId:"minionrunner-c5d40",storageBucket:"",messagingSenderId:"522343975744"});const t=firebase.database(),s=new p(i,e,t);document.querySelector(".menu-buttons").addEventListener("click",e=>{const i=document.querySelector(".game-area"),t=document.querySelector(".menu"),n=document.querySelector(".jump-button"),o=document.querySelector(".global-high-scores");i.classList.remove("hide"),n.classList.remove("hide"),t.classList.add("hide"),o.classList.add("hide"),setTimeout(()=>s.start(e.target.id),200)})})}]);
//# sourceMappingURL=bundle.js.map